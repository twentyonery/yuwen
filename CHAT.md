## 项目开发流程说明
### 目录
1. 用元提示词生成工程提示词；
2. 用工程提示词生成初始代码；
3. 用对话的方式让通义灵码修改代码直至可以成功运行；

### 用到的元提示词 

```text
你是一个prompt专家，现在我需要编写一个基于PC端WEB页面的游戏，请为我撰写一段专业的prompt，后续我会使用这个prompt去找AI生成这个游戏。

游戏名称：语闻

游戏设定：

当现代社会高速发展，效率和速度逐渐成为人们唯一的追求，那源远流长而博大精深的文明逐渐被人遗忘，人文的价值被贬低，被质疑。虚无主义腐蚀着人心，不知“意义”的人与螺丝并没有区别。
在“人”迷失之际，在“文”消逝之际，历史洪流深处传出回响，古老的英灵竟再度熠熠生辉。
玩家是一名倒买倒卖勉强维生的小商人，平常多与电子零件打交道。但是今天，他接手的货物中竟然多出了七样不同寻常的物件。
正好奇的摸索着其中一件，他突然感觉到一阵眩晕，随后失去意识
恢复意识后，他发现自己身在一片漆黑中，听到一道陌生的声音。
那道声音告诉玩家，玩家必须猜出他是谁，才可以离开。

整个游戏分为三幕：开始页，交互页，结果页。

开始页交代游戏背景，同时给出七件符合分别符合张衡、王之涣、姜夔、西帕提亚、张骞、曹雪芹、王希孟形象的物件（文物），让玩家进行选择。选择后进入交互页。

根据玩家选择的古人文物生成交互页。

交互页允许用户输入问题，允许用户看到古人的回答。古人由某个AI chatbot扮演。这个AI chatbot的接口参数由特定的配置文件指定。在进入交互页时，AI要先给出一定信息，不能太明显，但一定要给玩家一些线索和突破口。

当玩家猜出正确的古人时，进入结束页。

结果页，根据特定古人的生平和成就生成一段动画视频，科普的同时要有情绪感染力。

结果页要有可以返回开始页的按键。

额外要求：

1、整个游戏画面出现的任何信息，包括游戏背景介绍，包括互动提示，都必须是中文。
2、在开始页和交互页，不要出现古人名字。
3、当处理古人名字时，要注意同义词的等价性。比如：唐太宗==李世民。当答案是李世民时，如果对方猜测唐太宗，也应该判对。
4、所有游戏中用的AI，应单独配置AI服务器，提供相应的能力。相关配置应放入相应的配置文件中。
5、除了AI相关能力外，没有另外的后端服务。
6、为所有的角色提供统一的系统提示词模版，并使用同一个AIchatbot。
7、对于角色同义词判断，交由后端AI去执行，不需要使用前端同义词配置文件。

要求这个prompt给到的产出：

1、README.md文件，清晰阐述项目创意、功能、运行/部署指南。若提供可执行成果（如网站链接、可执行文件、安装包等），须明确说明访问/获取方式，可执行文件应发布至仓库的Release区域。
2、CHAT.md文件，清晰描述vibe coding流程，提供用户输入的完整Prompt序列（包括生成项目源文件的prompt，以及对扮演特工的AI chatbot的prompt）。
3、完整源代码。

请你在当前路径下生成一个名为prompt.txt的文件，并把prompt写入文件中。
这个prompt的产出物应该如上所述，而不是再生成一个prompt。

```

### 用到的工程提示词（由上述元提示词生成的prompt.txt）

```markdown

你是一位资深的全栈Web应用工程师和系统架构师。你的任务是根据以下详细需求，直接设计、开发并交付一个完整的、可部署的PC端Web游戏项目。该项目需采用现代Web技术栈（HTML5, CSS3, JavaScript/ES6+），并通过前端JavaScript直接与**单一**外部AI服务进行通信，无额外后端服务。

### 项目名称: 语闻 (Yuwen)

### 项目概述:
这是一个以中国历史人物为主题的单页互动解谜Web应用。玩家扮演一位现代小商人，因接触神秘古文物而穿越，必须通过与由**同一个**外部AI服务扮演的不同历史人物进行对话来猜测其身份。项目是一个纯前端应用，通过AJAX/Fetch API与配置好的外部AI服务进行通信。AI服务本身负责处理角色扮演和同义词判断。

### 核心功能模块:

1.  **前端 (Frontend - HTML/CSS/JavaScript)**:
    *   **开始页 (Start Page)**:
        *   展示游戏标题“语闻”和详尽的背景故事（使用提供的文本）。
        *   背景故事需用精美的中文排版呈现。
        *   以视觉上吸引人的方式展示七件代表不同历史人物（张衡、王之涣、姜夔、西帕提亚、张骞、曹雪芹、王希孟）的文物图标/图片。
        *   玩家点击任一文物，触发事件，通过JavaScript读取配置文件获取AI服务信息和所选角色的标识，然后跳转到交互页。
        *   **严格遵守**: 此页面**绝不**能直接显示历史人物的名字。
    *   **交互页 (Interaction Page)**:
        *   页面标题动态显示为“与...对话”（...部分为动态内容，但不显示人名）。
        *   实现一个实时聊天界面，包含消息历史记录区、用户输入框和提交按钮。
        *   前端JavaScript直接通过 `fetch` 或 `XMLHttpRequest` 调用外部AI服务的API。
        *   在进入此页时，前端根据所选角色，从配置中读取AI服务地址和**通用系统Prompt模板**，将所选角色信息（如角色ID或名称）填充到模板中，构造初始请求发送给AI，获取初始回复（欢迎语）并显示。
        *   用户输入问题后，前端将问题、当前会话上下文以及所选角色信息发送给AI服务。AI服务负责理解问题、扮演角色并生成回复。
        *   当用户输入猜测（如“你是张衡吗？”）时，前端将这条消息和角色信息一同发送给AI。AI服务负责判断猜测是否正确（包括处理同义词），并在回复中给出指示（例如，“恭喜你，猜对了！”或“再想想看？”）。前端根据AI的特定回复（需要在 `CHAT.md` 中定义好这些触发词）来决定是否跳转到结果页。
    *   **结果页 (Result Page)**:
        *   当前端根据AI的回复判断玩家猜对身份后，跳转至此页。
        *   展示一段为该历史人物量身定制的介绍性文字，内容涵盖其生平、主要成就，并富有情感和科普价值。
        *   （视频播放功能为未来扩展预留，当前可展示图文介绍）。
        *   页面底部提供一个明显的“返回开始页”按钮。

2.  **AI服务集成与配置**:
    *   **单一AI服务**: 项目只与一个外部AI服务通信。
    *   **配置文件 (`config/ai_config.json`)**:
        *   存放AI服务的连接信息（API端点URL）、认证方式（如API Key的Header名称和值，需使用占位符如 `YOUR_API_KEY_HERE`）。
        *   存放**通用的系统Prompt模板**，其中包含占位符，用于在每次请求时注入具体的角色信息。
        *   存放每个历史人物的标识信息（用于填充Prompt模板）。
        *   **示例结构**:
            ```json
            {
              "api_settings": {
                "endpoint": "https://api.your-ai-service.com/v1/chat/completions",
                "headers": {
                  "Authorization": "Bearer YOUR_API_KEY_HERE",
                  "Content-Type": "application/json"
                }
              },
              "system_prompt_template": "你正在扮演中国历史上的著名人物。你的身份是：{character_name}。你的背景是：{character_background}。你的回答应符合你的身份和时代背景，提供线索但不直接说出名字。当用户猜测你的身份时，如果猜对（需判断同义词），请回复'[[[CORRECT_GUESS]]]'；如果猜错，请给出提示。用户当前的选择是：{selected_character_id}",
              "characters": {
                "zhang_heng": {
                  "id": "zhang_heng",
                  "display_name": "张衡",
                  "background": "东汉时期伟大的科学家、文学家，发明了地动仪。"
                },
                "wang_zhihuan": { ... }
              }
            }
            ```
    *   **同义词处理**: **由外部AI服务全权负责**。前端只需将用户的问题和猜测原样发送给AI，AI根据其强大的语言理解能力判断同义词并给出正确与否的反馈。

3.  **静态资源 (Assets)**:
    *   所有文物图片、背景图、图标等静态资源应存放在 `public/assets` 或 `static` 文件夹中，并通过相对路径引用。

### 技术与内容要求:
*   **语言**: 游戏内所有文本（背景故事、提示、按钮文字等）必须为**中文**。
*   **国际化**: 虽然内容是中文，但代码注释和变量命名建议使用英文，以提高可维护性。
*   **响应式设计**: 虽然主要面向PC端，但应具备基本的响应式能力，确保在常见分辨率下布局合理。
*   **代码质量**: 代码需结构清晰、模块化、注释完整，遵循所选技术栈的最佳实践。
*   **安全性**: 由于是纯前端应用，API密钥会暴露在客户端代码中，这是此架构的固有风险。在交付物中，配置文件中的密钥必须使用占位符，并在 `README.md` 中明确说明此风险及如何配置。
*   **无后端**: 除了外部AI服务，项目本身不包含任何后端代码或服务。所有逻辑都在前端实现，同义词判断依赖AI。

### 最终交付物:
请将以下所有内容打包在一个文件夹中，并提供清晰的说明文档。

1.  **README.md**:
    *   项目名称、一句话描述。
    *   详细阐述项目创意、核心功能模块（特别是前端如何与单一AI交互，以及同义词判断由AI负责）。
    *   明确的运行/部署指南：
        *   如何在本地运行（例如，使用 `Live Server` VSCode插件打开 `index.html`，或使用 `python -m http.server` 启动一个简单的HTTP服务器）。
        *   如何配置AI服务（如何获取API Key，如何填写 `config/ai_config.json` 中的占位符）。
        *   **重点强调**: 由于是纯前端应用，直接打开 `index.html` 可能会因浏览器的CORS策略而无法调用AI API，推荐使用本地服务器。
    *   项目文件夹结构说明。
    *   （可选）如果已部署，提供在线演示链接（注意：部署版本的配置文件中不应包含真实的API密钥）。

2.  **CHAT.md**:
    *   提供用于指导外部AI服务的**通用Prompt模板**（与 `config/ai_config.json` 中的 `system_prompt_template` 一致）。
    *   详细说明前端如何根据此模板和所选角色生成具体的系统Prompt。
    *   明确定义AI在判断猜测正确时应返回的**触发词**（例如 `[[[CORRECT_GUESS]]]`），以便前端监听并跳转页面。
    *   可以包含一些调用AI API的示例请求和预期回复，以展示其行为。

3.  **完整源代码和资源**:
    *   前端代码 (HTML, CSS, JavaScript)。
    *   `config` 文件夹及其中的配置文件 (`ai_config.json`)。
    *   `public` 或 `static` 文件夹及其中的静态资源 (图片等)。
    *   （如果使用了构建工具或包管理器）项目依赖声明文件 (如 `package.json`) 和构建脚本说明。

请开始你的开发工作，将最终成果组织好，交付一个功能完备、结构清晰、文档齐全的纯前端Web应用项目。

```

### debug时和灵码对话的提示词

* 我在调用后端API的时候遇到以下错误：Access to fetch at 'https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation' from origin 'http://127.0.0.1:5500' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource.
请问应该如何解决
* 请按照方案2：使用阿里云提供的SDK修改代码
* 我一进入chat.html就直接显示“[[[CORRECT_GUESS]]]恭喜你，猜对了！我是王之涣。”，这个逻辑显然是错误的，请修改代码。
* 现在在chat.html的标题直接显示了古人名字，这是不正确的，这个名字应该被掩盖或者打码。只有在结果页才能显示古人名字。请修改代码
* 检查项目中的所有代码，其中“返回开始页”时，不可以返回start.html，而是应该返回index.html。
* 在chat.html页面，我们不管输入什么问题，它回答的都是恭喜你猜对了。这显然是错误的。请你修改代码
* 该问题仍然存在，刚才的修改并没有解决实际问题。请仔细思考，重新修改代码。
* 现在用户猜对之后，在chat.html界面停留的时间太短。请改为停顿五秒。
* 现在在AI生成回复期间，屏幕上没有任何提示，这会让用户在等待过程中无聊。请你修改代码，在AI生成文字期间显示“古人低语，请耐心等待”提示。
* 请在初始页添加bgm，且设计成进入初始页自动播放bgm，保留按钮可以关闭bgm。
* 将start.jpg设置为初始页背景。
* 将初始页七件图片改成上面四个下面三个的格式，并且将七个图标改成一样大小，适当缩小尺寸不要太拥挤。
* 将chat1到7设置为七个不同文物交互界面的bgm。
* 将start.jpg设计为交互页背景图。
* 将所有带有对应名字+2的图片设置为结束页对应人物的背景图。
* 结束页适当调整字体大小和排版，露出人物主体。
* 初始页xipatiya图片无法加载，请修改代码。
* 将结束页文字位置向下移动不要遮挡图片中人物的脸。
* 在初始页右上方增加一个可以调整bgm开关的按键。